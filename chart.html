<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <style>

    .pieContainer {
      height: 150px;
      position: relative;
    }
    
    .pieBackground {
      position: absolute;
      width: 150px;
      height: 150px;
      border-radius: 100%;
      box-shadow: 0px 0px 8px rgba(0,0,0,0.5);
    } 
    
    .pie {
      transition: all 0.4s;
      position: absolute;
      width: 150px;
      height: 150px;
      border-radius: 100%;
      clip: rect(0px, 75px, 150px, 0px);
    }
    
    .hold {
      position: absolute;
      width: 150px;
      height: 150px;
      border-radius: 100%;
      clip: rect(0px, 150px, 150px, 75px);
      transition: 1s all ;
    }
   
    
    .innerCircle {
      position: absolute;
      width: 120px;
      height: 120px;
      background-color: #444;
      border-radius: 100%;
      top: 15px;
      left: 15px; 
      box-shadow: 0px 0px 8px rgba(0,0,0,0.5) inset;
      color: white;
      z-index: 10;
    }

    .innerCircle .content {
      position: absolute;
      display: block;
      width: 120px;
      top: 30px;
      left: 0;
      text-align: center;
      font-size: 14px;
    }
    
    .flex-center{
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100vh;
    }
  </style>
</head>
<body>


<div class='flex-center'>
  <div class="pieContainer">
    <div class="pieBackground"></div>
  
    <div class="innerCircle">
      <div class="content">
      <b>Data</b><br>from 16<sup>th</sup> April, 2014</div>
    </div>
  </div>
  
</div>

  <script>
    let arr=[
      {size:2,color:'red'},
      {size:2,color:'blue'},
      {size:1,color:'green'},
      {size:3,color:'yellow'}
    ];
    let pieContainer = document.querySelector('.pieContainer')
    let rotate = 0;
    let point = 360/(arr.reduce((acc, cur) =>acc + cur.size,0))
    let half = (arr.reduce((acc, cur) =>acc + cur.size,0))/2

    let firstHold = null;

    function overHandler(event,i,hold,rotatePos,pie,firstHold,lastItem){
      
      
        
      pie.onmouseover = function(e){
          e.stopPropagation()
        // if(pie.parentNode == hold){
          // console.log(pie)
          // if(pie.contains(e.target)){
            // console.log('ok')
            hold.style.cursor = 'pointer'
            hold.style.transform = `${rotatePos} scale(1.2)`;
            document.getElementsByClassName('content')[0].innerHTML =  i.size
          // }
        // }else{
        //   console.log('hello')
        }
        if(lastItem){
        hold.onmouseover = function(e){
          console.log('hello')
          // firstHold.style.cursor = 'pointer'
          firstHold.style.transform = `rotate(${0}deg) scale(1.2)`;
          // document.getElementsByClassName('content')[0].innerHTML =  i.size
        }
      }
        // hold.onmouseleave = function(e){
        //   // console.log('hello')
        //   // firstHold.style.cursor = 'pointer'
        //   // console.log(firstHold)
        //   firstHold.style.display = `rotate(${0}deg) scale(1)`;
        //   // document.getElementsByClassName('content')[0].innerHTML =  i.size
        // }
        // if(i!==1){
        //   firstHold.style.zIndex = 3
        // }else{
        //   firstHold.style.zIndex = 0
        // }
        // console.log('ok')
        
      // }
    }

    arr.forEach((i,k)=>{

 
      let hold = document.createElement('div')
      hold.className = 'hold'
      let pie = document.createElement('div')
      pie.className = 'pie'
      pieContainer.appendChild(hold)
      hold.appendChild(pie)
      

      if (k === 0 ) {
        firstHold = hold;
        // hold.style.zIndex = 3
      }

      if(i.size >  half){
        let littlePiece = i.size - half

        pie.style.transform = `rotate(${point*half}deg)`;
        hold.style.transform = `rotate(${rotate}deg)`;
        rotate+=point*half;
        pie.style.backgroundColor = i.color;

        let littlehold = document.createElement('div')
        littlehold.className = 'hold'
        let littlepie = document.createElement('div')
        littlepie.className = 'pie'
        pieContainer.appendChild(littlehold)
        littlehold.appendChild(littlepie)
        littlepie.style.transform = `rotate(${point*littlePiece}deg)`;
        littlehold.style.transform = `rotate(${rotate}deg)`;
        rotate+=point*littlePiece;
        littlepie.style.backgroundColor = i.color;


      }else{
        pie.style.transform = `rotate(${point*i.size}deg)`;
        hold.style.transform = `rotate(${rotate}deg)`;
        let rotatePos = hold.style.transform
        let fired = true
        function resolveStale(x){
          if(k==arr.length-1){
            console.log('hello')
            // firstHold.style.cursor = 'pointer'
            firstHold.style.transform = `rotate(${0}deg) scale(1.2)`;
            // document.getElementsByClassName('content')[0].innerHTML =  i.size
          }
        }
        hold.onmousemove = function(e){
          
          pie.onmousemove = function(e){
            e.stopPropagation()
            hold.style.cursor = 'pointer'
            hold.style.transform = `${rotatePos} scale(1.2)`;
            document.getElementsByClassName('content')[0].innerHTML =  i.size
            // fired = pie.contains(e.target) && hold !=firstHold
            // console.log(fired)
          }
          // console.log('ok')
          // overHandler(e,i,hold,rotatePos,pie,firstHold,k==arr.length-1)
          resolveStale()
        // firstHold.style.zIndex = k !== 0? 3:0
          
          
          
        }
        pie.onmouseleave = function(){
          
          hold.style.transform = rotatePos;
          if(k==arr.length-1){
            fired = false
            firstHold.style.transform = `rotate(${0}deg) scale(1)`;
          }
          
        }
        rotate+=point*i.size;
        pie.style.backgroundColor = i.color;
      }
      

    })



  </script>
</body>
</html>